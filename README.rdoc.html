<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="custom.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="syntax_highlight.css" type="text/css" charset="utf-8" />

    <title>README.rdoc</title>
  </head>
  <body>
    <div id="content">
      <div class="section docstring readme">
        <h1>BigIndex</h1>
<p>
A Rails plugin that drops into models and provides indexing functionality.
Uses an adapter/repository pattern inspired by Datamapper to abstract the
actual indexer used in the background, and exposes the model to a simple
indexing API.
</p>
<p>
This should be used in conjunction with BigRecord in order to provide a
more complete ORM.
</p>
<h2>Supported search servers</h2>
<ul>
<li>Solr

</li>
<li>Sphinx (planned)

</li>
</ul>
<h2>Installation</h2>
<p>
(1) Install the Solr search server into your Rails application with the
bigindex-solr package [http://github.com/openplaces/bigindex-solr].
Alternatively, if you want to setup your own Solr server, you&#8217;ll need
to read the [Solr schema] section below and take note of the Solr url to
connect to.
</p>
<p>
(2) In your Rails application, add Bigindex as a gem to your
config/environment.rb file:
</p>
<pre class="code">
  <span class='config identifier id'>config</span><span class='dot token'>.</span><span class='gem identifier id'>gem</span> <span class='string val'>&quot;bigindex&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:source</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;http://gemcutter.org&quot;</span>
</pre>
<p>
and run the following rake task to install all the gems listed for your
Rails app:
</p>
<pre class="code">
  <span class='lbrack token'>[</span><span class='sudo identifier id'>sudo</span><span class='rbrack token'>]</span> <span class='rake identifier id'>rake</span> <span class='gems identifier id'>gems</span><span class='symbol val'>:install</span>
</pre>
<p>
(3) Add the following line to the bottom of your RAILS_ROOT/Rakefile
</p>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>'big_index/tasks'</span>
</pre>
<h3>NOTE: Skip steps (4) and (5) if you&#8217;re using the bigindex-solr package.</h3>
<p>
(4) Create a Bigindex config file for your Rails application
</p>
<pre class="code">
  <span class='rake identifier id'>rake</span> <span class='bigindex identifier id'>bigindex</span><span class='symbol val'>:generate_config</span>
</pre>
<p>
(5) Modify the config file config/bigindex.yml[.sample] to correspond to
your Solr server.
</p>
<h2>Getting Started</h2>
<p>
Modify your Ruby class/model similarly to the following:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Model constant id'>Model</span> <span class='lt op'>&lt;</span> <span class='BigRecord constant id'>BigRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='include identifier id'>include</span> <span class='BigIndex constant id'>BigIndex</span><span class='colon2 op'>::</span><span class='Resource constant id'>Resource</span>                    <span class='comment val'># 1. Include the BigIndex::Resource module into your model.</span>

    <span class='column identifier id'>column</span> <span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='symbol val'>:string</span>
    <span class='column identifier id'>column</span> <span class='symbol val'>:description</span><span class='comma token'>,</span> <span class='symbol val'>:text</span>

    <span class='index identifier id'>index</span> <span class='symbol val'>:name</span><span class='comma token'>,</span>  <span class='symbol val'>:string</span>                         <span class='comment val'># 2. Define each attribute you want to index along with its type.</span>
    <span class='index identifier id'>index</span> <span class='symbol val'>:description</span>                            <span class='comment val'># Defaults to type :text</span>
  <span class='end end kw'>end</span>
</pre>
<p>
BigIndex will then override the default Model.find() method to pass through
the indexer first. Model.find() will also accept the option <tt>=&amp;gt; true</tt>, which bypasses the indexed #find method and dispatches it to
the original Model.find() method, e.g. Model.find(:all, :bypass_index =&gt;
true). Alternatively, you can use Model.find_without_index(:all) for the
same functionality.
</p>
<h2>Rebuilding your index</h2>
<p>
Once you have your models setup with Bigindex, you will need to rebuild the
index. To do so, run the rake task:
</p>
<pre class="code">
  <span class='rake identifier id'>rake</span> <span class='bigindex identifier id'>bigindex</span><span class='symbol val'>:rebuild_index</span>
</pre>
<p>
This rake task accepts the following options:
</p>
<pre class="code">
 <span class='mult op'>*</span> <span class='BATCH_SIZE constant id'>BATCH_SIZE</span><span class='colon op'>:</span> <span class='Defaults constant id'>Defaults</span> <span class='to identifier id'>to</span> <span class='float val'>100</span><span class='dot token'>.</span> <span class='For constant id'>For</span> <span class='each identifier id'>each</span> <span class='model identifier id'>model</span><span class='comma token'>,</span> <span class='it identifier id'>it</span> <span class='will identifier id'>will</span> <span class='batch identifier id'>batch</span> <span class='process identifier id'>process</span> <span class='this identifier id'>this</span> <span class='number identifier id'>number</span> <span class='of identifier id'>of</span> <span class='records identifier id'>records</span> <span class='at identifier id'>at</span> <span class='a identifier id'>a</span> <span class='time identifier id'>time</span><span class='dot token'>.</span>
 <span class='mult op'>*</span> <span class='CLEAR constant id'>CLEAR</span><span class='colon op'>:</span> <span class='Defaults constant id'>Defaults</span> <span class='to identifier id'>to</span> <span class='true true kw'>true</span><span class='dot token'>.</span> <span class='Before constant id'>Before</span> <span class='rebuilding identifier id'>rebuilding</span> <span class='the identifier id'>the</span> <span class='model identifier id'>model</span><span class='comma token'>,</span> <span class='drop identifier id'>drop</span> <span class='the identifier id'>the</span> <span class='current identifier id'>current</span> <span class='index identifier id'>index</span> <span class='before identifier id'>before</span> <span class='rebuilding identifier id'>rebuilding</span> <span class='it identifier id'>it</span><span class='dot token'>.</span>
 <span class='mult op'>*</span> <span class='OPTIMIZE constant id'>OPTIMIZE</span><span class='colon op'>:</span> <span class='Defaults constant id'>Defaults</span> <span class='to identifier id'>to</span> <span class='true true kw'>true</span><span class='dot token'>.</span> <span class='A constant id'>A</span> <span class='Solr constant id'>Solr</span> <span class='option identifier id'>option</span> <span class='to identifier id'>to</span> <span class='optimize identifier id'>optimize</span> <span class='the identifier id'>the</span> <span class='index identifier id'>index</span> <span class='after identifier id'>after</span> <span class='it identifier id'>it</span><span class='string val'>'s created.
</span></pre>
<p>
An example usage is:
</p>
<pre class="code">
  <span class='rake identifier id'>rake</span> <span class='bigindex identifier id'>bigindex</span><span class='symbol val'>:rebuild_index</span> <span class='BATCH_SIZE constant id'>BATCH_SIZE</span><span class='assign token'>=</span><span class='integer val'>150</span> <span class='CLEAR constant id'>CLEAR</span><span class='assign token'>=</span><span class='true true kw'>true</span> <span class='OPTIMIZE constant id'>OPTIMIZE</span><span class='assign token'>=</span><span class='true true kw'>true</span>
</pre>
<h2>Drop current index</h2>
<p>
To drop the index of your current environment, use:
</p>
<pre class="code">
  <span class='rake identifier id'>rake</span> <span class='bigindex identifier id'>bigindex</span><span class='symbol val'>:drop_index</span>
</pre>
<p>
This will drop the index of any model in your RAILS_ROOT/app/models folder
that includes BigIndex::Resource. Be very careful with this task!
</p>
<h2>Solr schema</h2>
<p>
Bigindex has a defined schema to use with Solr. If you need to set up Solr
yourself, you&#8217;ll need to either use the schema.xml defined in this
project, or create a merged version of it with your own.
</p>
<h2>License</h2>
<p>
Bigindex is released under the MIT license.
</p>
<h2>Credit</h2>
<p>
Bigindex was derived from the work of Data Mapper and parts of
acts_as_solr.
</p>
<h2>Links</h2>
<ul>
<li>Contact Us

<ul>
<li>Website - http://www.bigrecord.org

</li>
<li>IRC Channel - <tt>#bigrecord</tt> on irc.freenode.net

</li>
</ul>
</li>
</ul>

      </div>
    </div>
    <div id="yard_info">
  Generated on Thursday, November 26 2009 at 05:30:29 PM by 
  <abbr class="yard" title="Yay! A Ruby Documentation Tool"><a href="http://yard.soen.ca">YARD</a></abbr> 
  0.2.3.5 (ruby-1.8.7).
</div>

  </body>
</html>